<html lang="ro">
<head>
    <meta charset="UTF-8">
    <title>Mr. Smoothie</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee+Outline&display=swap" rel="stylesheet">
</head>
<body>
    <header class="navbar">
        <a href="home.html">
            <img src="logo_smoothie.png" class="logo">
        </a>
        <nav>
            <a href="home.html">AcasÄƒ</a>
            <a href="about.html">Despre</a>
            <a href="menu.html">Meniu</a>
            <a href="cart.html">CoÈ™</a>
            <a href="contact.html">Contact</a>
        </nav>
        <button id="modeToggle">ğŸŒ™</button>

    </header>

    <section class="cart-section">
        <h1 class="heading">CoÈ™ul Meu</h1>

        <div id="cartItemsContainer" class="cart-items-container">
            </div>

        <div class="cart-summary">
            <h2 id="cartTotal">Total: 0.00 lei</h2>
        </div>
        
        <div class="checkout-container">
            <button id="checkoutBtn" class="cta-button" onclick="openModal()">FinalizeazÄƒ Comanda</button>
        </div>
        
        <p id="confirmationMessage" class="confirmation-message">
            Comanda dumneavoastrÄƒ a fost trimisÄƒ, plata se va efectua la venirea comenzii!
        </p>

    </section>

    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <h2 class="heading">Detalii Livrare</h2>
            <form id="deliveryForm">
                <div class="input-group">
                    <label for="clientName">Nume È™i Prenume*</label>
                    <input type="text" id="clientName" required>
                </div>
                <div class="input-group">
                    <label for="clientAddress">Adresa completÄƒ*</label>
                    <input type="text" id="clientAddress" required>
                </div>
                <div class="input-group">
                    <label for="clientPhone">NumÄƒr de telefon*</label>
                    <input type="tel" id="clientPhone" required pattern="[0-9]{10}">
                    <small>Format: 10 cifre (ex: 07xxxxxxxx)</small>
                </div>
                <button type="submit" class="cta-button send-button">Trimite Comanda pe WhatsApp</button>
            </form>
        </div>
    </div>

    <div class="help-container">
        <button id="cartHelpBtn" class="help-button" aria-label="Ajutor CoÈ™ de CumpÄƒrÄƒturi">
            ?
        </button>

        <div id="cartHelpPopup" class="help-popup">
            <span class="close-popup" onclick="closeCartHelp()">&times;</span>
            <h3>Cum plasezi comanda:</h3>
            <ul>
                <li>1. SelectaÈ›i smoothie-urile dorite din pagina <a href="menu.html">Meniu</a>.</li>
                <li>2. Ãn CoÈ™, puteÈ›i ajusta numÄƒrul de bucÄƒÈ›i (folosind butoanele +/-).</li>
                <li>3. La apÄƒsarea butonului "FinalizeazÄƒ Comanda", se va deschide formularul de livrare.</li>
                <li>4. DupÄƒ completarea datelor, comanda va fi trimisÄƒ cÄƒtre Mr. Smoothie.</li>
            </ul>
        </div>
    </div>

    <script>
        const modeToggle = document.getElementById('modeToggle');

        // verificÄƒm dacÄƒ existÄƒ modul salvat
        if(localStorage.getItem('mode')) {
            document.body.className = localStorage.getItem('mode');
            modeToggle.textContent = document.body.classList.contains('dark-mode') ? 'â˜€ï¸' : 'ğŸŒ™';
        }

        modeToggle.addEventListener('click', () => {
            if(document.body.classList.contains('dark-mode')) {
                document.body.classList.remove('dark-mode');
                document.body.classList.add('light-mode');
                localStorage.setItem('mode', 'light-mode');
                modeToggle.textContent = 'ğŸŒ™';
            } else {
                document.body.classList.remove('light-mode');
                document.body.classList.add('dark-mode');
                localStorage.setItem('mode', 'dark-mode');
                modeToggle.textContent = 'â˜€ï¸';
            }
        });
    </script>

    <script>
    // Cod pentru evidenÈ›ierea linkului activ
    document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('header nav a');
    const currentPath = window.location.pathname.split('/').pop(); // Extrage numele fiÈ™ierului

    navLinks.forEach(link => {
        // ObÈ›ine numele fiÈ™ierului din href (ex: 'home.html')
        const linkPath = link.getAttribute('href'); 
        
        // VerificÄƒm dacÄƒ linkPath este gol ('') - cazul linkului CoÈ™, pe care l-ai lÄƒsat gol. 
        // DacÄƒ este 'home.html' È™i currentPath este gol (index.html sau home.html dacÄƒ este setat ca paginÄƒ principalÄƒ), 
        // sau dacÄƒ linkPath se potriveÈ™te cu currentPath, adÄƒugÄƒm clasa 'active'.
        if (linkPath === currentPath) {
            link.classList.add('active');
        } else if (currentPath === "" && linkPath === "home.html") {
            // Caz special: dacÄƒ pagina curentÄƒ este rÄƒdÄƒcina, activeazÄƒ linkul 'AcasÄƒ'
            link.classList.add('active');
        }
        });
    });
    </script>

    <script>
let cartItems = [];
let total = 0; // Variabila totalÄƒ globalÄƒ

const modal = document.getElementById('checkoutModal');
const form = document.getElementById('deliveryForm');

// --- FuncÈ›ii de bazÄƒ pentru CoÈ™ (Rendere È™i Manipulare) ---

function renderCart() {
    const container = document.getElementById('cartItemsContainer');
    const totalElement = document.getElementById('cartTotal');
    total = 0; // ResetÄƒm totalul
    container.innerHTML = ''; // GoleÈ™te containerul

    cartItems = JSON.parse(localStorage.getItem('smoothieCart')) || [];

    if (cartItems.length === 0) {
        // AsigurÄƒ-te cÄƒ aceste ID-uri/clase existÄƒ Ã®n HTML-ul tÄƒu complet
        if (container) {
             container.innerHTML = '<p class="empty-cart-message">CoÈ™ul este gol!</p>';
        }
        if (totalElement) {
             totalElement.textContent = 'Total: 0.00 lei';
        }
        const checkoutBtn = document.getElementById('checkoutBtn');
        if (checkoutBtn) {
            checkoutBtn.disabled = true;
        }
        return;
    }
    
    document.getElementById('checkoutBtn').disabled = false;

    cartItems.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;

        const itemDiv = document.createElement('div');
        itemDiv.className = 'cart-item';
        itemDiv.innerHTML = `
            <div class="item-name">${item.name}</div>
            <div class="item-details">
                <div class="item-quantity">
                     <button onclick="changeQuantity(${index}, -1)">-</button>
                     <span>${item.quantity}</span> x ${item.price} lei
                     <button onclick="changeQuantity(${index}, 1)">+</button>
                </div>
                <div class="item-price">${itemTotal.toFixed(2)} lei</div>
                <button class="remove-btn" onclick="removeItem(${index})">X</button>
            </div>
        `;
        container.appendChild(itemDiv);
    });

    totalElement.textContent = `Total: ${total.toFixed(2)} lei`;
}

function updateLocalStorage() {
    localStorage.setItem('smoothieCart', JSON.stringify(cartItems));
    renderCart();
}

function changeQuantity(index, delta) {
    cartItems[index].quantity += delta;
    if (cartItems[index].quantity <= 0) {
        removeItem(index);
        return;
    }
    updateLocalStorage();
}

function removeItem(index) {
    cartItems.splice(index, 1);
    updateLocalStorage();
}


// --- FuncÈ›ii Modal È™i Finalizare ComandÄƒ ---

function openModal() {
    if (cartItems.length === 0) {
         alert("CoÈ™ul este gol. AdaugÄƒ produse Ã®nainte de a finaliza comanda!");
         return;
    }
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    modal.style.display = 'none';
    document.body.style.overflow = '';
}

function finalizeOrder() {
    const clientName = document.getElementById('clientName').value;
    const clientAddress = document.getElementById('clientAddress').value;
    const clientPhone = document.getElementById('clientPhone').value;
    
    // FormatÄƒm mesajul comenzii
    const totalText = document.getElementById('cartTotal').textContent.replace('Total: ', '');
    let message = "COMANDA MR. SMOOTHIE:\n";

    cartItems.forEach(item => {
        message += `${item.quantity} x ${item.name} (${item.price} lei/buc)\n`;
    });

    message += `\n--- DETALII LIVRARE ---\n`;
    message += `Nume: ${clientName}\n`;
    message += `AdresÄƒ: ${clientAddress}\n`;
    message += `Telefon: ${clientPhone}\n`;
    message += `\nCOST TOTAL: ${totalText}`;
    message += "\n\nPlata se face la livrare.";
    
    // CodificÄƒm mesajul pentru URL
    const encodedMessage = encodeURIComponent(message);
    const phoneNumber = '+40754057556';
    
    // Deschide WhatsApp
    const whatsappLink = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
    
    window.open(whatsappLink, '_blank');
    
    // Ãnchide modalul
    closeModal();
    
    // AfiÈ™eazÄƒ mesajul de confirmare (AsigurÄƒ-te cÄƒ acest ID existÄƒ Ã®n HTML-ul tÄƒu complet)
    const confirmationMessage = document.getElementById('confirmationMessage');
    if (confirmationMessage) {
        confirmationMessage.style.display = 'block';
    }
    
    // GoleÈ™te coÈ™ul È™i re-randare
    localStorage.removeItem('smoothieCart');
    setTimeout(() => {
        renderCart();
    }, 1000); 
}

// --- Event Listeners È™i IniÈ›ializare ---

// FuncÈ›ia declanÈ™atÄƒ la trimiterea formularului
form.addEventListener('submit', function(e) {
    e.preventDefault();
    finalizeOrder();
});

// Ãnchide modalul la click Ã®n afara lui
window.onclick = function(event) {
    if (event.target == modal) {
        closeModal();
    }
}

// IniÈ›ializeazÄƒ coÈ™ul la Ã®ncÄƒrcarea paginii
window.onload = renderCart;
    </script>

    <script>
        function toggleCartHelp() {
            const popup = document.getElementById('cartHelpPopup');
            popup.classList.toggle('visible');
        }

        function closeCartHelp() {
             document.getElementById('cartHelpPopup').classList.remove('visible');
        }
        
        // AdÄƒugÄƒm evenimentul de click pe butonul de ajutor
        document.getElementById('cartHelpBtn').addEventListener('click', toggleCartHelp);
        
        // Ãnchide pop-up-ul la click Ã®n afara lui
        window.addEventListener('click', (event) => {
            const popup = document.getElementById('cartHelpPopup');
            const button = document.getElementById('cartHelpBtn');
            if (!popup.contains(event.target) && event.target !== button && popup.classList.contains('visible')) {
                closeCartHelp();
            }
        });
    </script>
</body>
</html>